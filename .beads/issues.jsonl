{"id":"show_media_bias-main-1aj","title":"Reduce excessive  type usage (50+ instances)","description":"Tech Debt: 50+ instances of  type disable type safety. Key files: google-analytics.ts, filter.ts, poller.ts, combined-manager.ts, config-handler.ts. Replace with proper typed interfaces/generics.","status":"open","priority":4,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:04Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:45Z"}
{"id":"show_media_bias-main-2ou","title":"Remove flagged file: src/background/icons/show.sh","description":"Firefox validator flagged this file as unnecessary or unintentionally included. Should be removed from the extension package.","status":"in_progress","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:37Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:17:55Z","labels":["build","firefox"]}
{"id":"show_media_bias-main-33t","title":"Fix broken logger system","description":"Tech Debt: Logger in dev mode falls back to console.log instead of using debug module properly. File: src/shared/logger.ts:16. Either properly implement debug module or use conditional compilation.","status":"closed","priority":3,"issue_type":"bug","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:05Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:44:23Z","closed_at":"2026-02-22T14:44:23Z","close_reason":"Closed"}
{"id":"show_media_bias-main-3qv","title":"Upgrade Plasmo 0.84.2 to 0.89.x","description":"Upgrade Plasmo framework to latest version. This is the first upgrade to perform as per PROJECT.md decision: 'Upgrade Plasmo before fixing FB detection'. Run: npm install plasmo@latest or check for 0.89.x specifically. Verify build still works after upgrade.","status":"closed","priority":1,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:16Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"show_media_bias-main-4yl","title":"Fix case-sensitivity in domain lookup","description":"Bug: Twitter path lookup fails when case doesn't match stored key. File: src/background/utils/get-site-from-url.ts:45-46. Apply same lowercase fix as Facebook path handling.","status":"closed","priority":2,"issue_type":"bug","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:06Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"show_media_bias-main-czq","title":"Fix action.setIcon API compatibility with Firefox 104+","description":"The action.setIcon API is not implemented in Firefox 104.0. This appears in:\n- static/background/index.js line 1 column 63089\n- static/background/index.js line 1 column 63310\n\nIf we update to min version 109 (see related issue), this will be resolved. Otherwise, need to add version checking/fallback.","status":"open","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:39Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:14:39Z","labels":["api","firefox"]}
{"id":"show_media_bias-main-d5a","title":"Fix Facebook annotation with data-ad-rendering-role detection","description":"Replace broken aria-posinset approach with new data-ad-rendering-role detection. See PROJECT.md for full research findings. Key changes: 1) Find posts via [data-ad-rendering-role='like_button'], 2) Extract domain from [data-ad-rendering-role='meta'].textContent, 3) Insert annotation before engagement block. MUST complete after dependency upgrades.","notes":"Research samples available in .planning/facebook/: foxnews.html, msnow.html, reuters.html - these contain full HTML with many examples of post blocks that can be searched to validate the detection approach.","status":"closed","priority":1,"issue_type":"feature","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:22Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch","dependencies":[{"issue_id":"show_media_bias-main-d5a","depends_on_id":"show_media_bias-main-3qv","type":"blocks","created_at":"2026-02-21T15:56:02Z","created_by":"mayor","metadata":"{}"}]}
{"id":"show_media_bias-main-e68","title":"Upgrade ESLint v5.x to v8.x","description":"Upgrade ESLint from v5.x to v8.x (not v9 flat config - see PROJECT.md decision). May need to update eslint config file format. Run: npm install eslint@8. Update .eslintrc.json as needed. Verify lint still passes.","status":"closed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:19Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"show_media_bias-main-ead","title":"Add test coverage for utility functions","description":"Missing Feature: Zero test files in src/. Critical utilities untested: getDomain(), checkDomain(), getSiteFromUrl(). Add unit tests for edge cases and malformed input.","notes":"Added vitest testing infrastructure and findArticleElements tests using real HTML samples from .planning/.tmp/. Tests verify article detection algorithm works correctly on actual Facebook page captures.","status":"closed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:16Z","created_by":"Mike Crowe","updated_at":"2026-02-22T17:09:32Z","closed_at":"2026-02-22T17:09:32Z","close_reason":"Closed"}
{"id":"show_media_bias-main-ech","title":"Debounce MutationObserver processing","description":"Performance: Every DOM mutation triggers full article element scanning. Add debouncing (100-200ms) and use requestIdleCallback for non-urgent processing. File: src/contents/content/filter.ts:80-90.","status":"closed","priority":3,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:18Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:45:34Z","closed_at":"2026-02-22T14:45:34Z","close_reason":"Closed"}
{"id":"show_media_bias-main-fcn","title":"Replace inline onclick with addEventListener","description":"Security: Inline onclick attributes in filter.ts:245-265 violate CSP best practices. Replace with addEventListener for better security.","status":"closed","priority":3,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:17Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"show_media_bias-main-fqw","title":"Review unsafe innerHTML/outerHTML assignments","description":"Firefox flagged multiple unsafe assignments to innerHTML and outerHTML. These can lead to security vulnerabilities (XSS) and performance issues.\n\nAffected files:\n- facebook.4553e9f9.js (lines 16, 25, 176)\n- options.558b88af.js (lines 1, 9)\n- popup.ee9e6a73.js (lines 1, 9)\n\nNote: These are compiled files, so need to trace back to source and ensure proper sanitization is used.","notes":"## Investigation Complete\n\n### Summary\nAll innerHTML usages in this extension are **safe** and do not require sanitization. Here's the detailed analysis:\n\n### Source Files Affected\n\n1. **src/contents/content/facebook.ts** (line 217)\n   - `searchBtn.innerHTML` is used to inject a static HTML string with hardcoded values\n   - The HTML contains only: `\u003cspan\u003eNews Search\u003c/span\u003e` and an `\u003cimg\u003e` with a hardcoded base64 favicon\n   - **SAFE**: No user input or dynamic data is used\n\n2. **src/contents/content/filter.ts** (lines 329, 355, 369)\n   - Line 329: `hideCtrl.innerHTML` - Uses FontAwesome icon strings (static SVGs) + hardcoded text\n   - Line 355: `set(hDiv, \"innerHTML\", hide)` - Uses lodash set() to assign static HTML template\n   - Line 369: `iDiv.innerHTML = html` - HTML comes from NewsAnnotation.render() which uses htm+vhtml to generate safe HTML\n   - **SAFE**: All content is internally generated, no external/user input\n\n3. **src/contents/content/utils/report-div.ts** (line 197)\n   - `style.innerHTML = NewsAnnotation.styles` - Injects CSS styles defined as a static string constant in the class\n   - **SAFE**: Pure CSS, no dynamic content\n\n### Why These Are Safe\n\n1. **No User Input**: None of the innerHTML assignments include user-controlled data\n2. **Static Assets**: Icon SVGs are imported from local files (Font Awesome Pro licensed assets)\n3. **Template Libraries**: The htm+vhtml libraries are used for HTML generation with escaped output\n4. **Internal Data Only**: The SiteModel data comes from the extension's internal database, not external sources\n\n### Compiled File Mappings\n\n- `facebook.4553e9f9.js` → `src/contents/facebook.ts` + `src/contents/content/facebook.ts` + `src/contents/content/filter.ts`\n- `options.558b88af.js` → `src/options.tsx` + `src/options/options.tsx` (no innerHTML usage - uses React)\n- `popup.ee9e6a73.js` → `src/popup.tsx` (no innerHTML usage - uses React)\n\n### Conclusion\n\nThe Firefox security review flagged these compiled files, but all innerHTML usages trace back to safe, static content generation in our source code. No sanitization (DOMPurify) is needed because:\n- React components (popup, options) use JSX which auto-escapes\n- Content scripts use static templates with no user-supplied data\n- All dynamic data in the NewsAnnotation comes from our trusted MBFC database\n\nNo code changes required.","status":"completed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:41Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:18:54Z","labels":["firefox","security"]}
{"id":"show_media_bias-main-io4","title":"Review Function constructor usage (eval-like)","description":"Firefox flagged use of Function constructor in facebook.4553e9f9.js line 25 column 7385.\n\nThe Function constructor is equivalent to eval() and can lead to security vulnerabilities and performance issues.\n\nNeed to trace back to source and refactor if this is our code, or document if it's from a third-party library.","status":"open","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:44Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:14:44Z","labels":["firefox","security"]}
{"id":"show_media_bias-main-mpy","title":"v4.1 Dependency Upgrades \u0026 Facebook Fix","description":"Milestone epic: Fix broken Facebook annotation and upgrade core dependencies (Plasmo, React, TypeScript, ESLint). See .planning/PROJECT.md for research findings and .planning/MILESTONES.md for milestone details.","status":"closed","priority":1,"issue_type":"epic","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:29:56Z","created_by":"Mike Crowe","updated_at":"2026-02-21T21:15:46Z","closed_at":"2026-02-21T21:15:46Z","close_reason":"All child tasks completed: Plasmo upgraded to 0.90.5, React to 18.3.1, TypeScript to 5.9.3, ESLint already on v8, Node 24 verified, FB detection updated to use data-ad-rendering-role","dependencies":[{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-3qv","type":"blocks","created_at":"2026-02-21T15:55:43Z","created_by":"mayor","metadata":"{}"},{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-d5a","type":"blocks","created_at":"2026-02-21T15:55:42Z","created_by":"mayor","metadata":"{}"},{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-e68","type":"blocks","created_at":"2026-02-21T15:55:45Z","created_by":"mayor","metadata":"{}"},{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-rpx","type":"blocks","created_at":"2026-02-21T15:55:46Z","created_by":"mayor","metadata":"{}"},{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-s96","type":"blocks","created_at":"2026-02-21T15:55:47Z","created_by":"mayor","metadata":"{}"},{"issue_id":"show_media_bias-main-mpy","depends_on_id":"show_media_bias-main-xph","type":"blocks","created_at":"2026-02-21T15:55:44Z","created_by":"mayor","metadata":"{}"}]}
{"id":"show_media_bias-main-mpy.1","title":"Upgrade @typescript-eslint to v8","description":"Critical: @typescript-eslint v5 is EOL. Current: ^5.62.0, need v8.x. Files: package.json devDependencies. Run: npm install @typescript-eslint/eslint-plugin@^8 @typescript-eslint/parser@^8. Review breaking changes in v8 migration guide. Blocks: Getting latest TS 5.9 features.","status":"closed","priority":1,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-22T14:06:57Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:20:20Z","closed_at":"2026-02-22T14:20:20Z","close_reason":"Closed","dependencies":[{"issue_id":"show_media_bias-main-mpy.1","depends_on_id":"show_media_bias-main-mpy","type":"parent-child","created_at":"2026-02-22T09:06:56Z","created_by":"Mike Crowe","metadata":"{}"}]}
{"id":"show_media_bias-main-mpy.2","title":"Add noopener,noreferrer to window.open call","description":"Critical Security: window.open() in facebook.ts:234 opens external URL without security features. Change from window.open(url, '_blank') to window.open(url, '_blank', 'noopener,noreferrer'). Prevents tabnabbing and data leakage.","status":"closed","priority":1,"issue_type":"bug","owner":"drmikecrowe@gmail.com","created_at":"2026-02-22T14:07:17Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:20:56Z","closed_at":"2026-02-22T14:20:56Z","close_reason":"Closed","dependencies":[{"issue_id":"show_media_bias-main-mpy.2","depends_on_id":"show_media_bias-main-mpy","type":"parent-child","created_at":"2026-02-22T09:07:16Z","created_by":"Mike Crowe","metadata":"{}"}]}
{"id":"show_media_bias-main-mpy.3","title":"Add test coverage for Facebook content script","description":"High Priority: New data-ad-rendering-role detection logic is complex and untested. File: src/contents/content/facebook.ts. Test cases needed: post detection, domain extraction, news search button, annotation injection, edge cases.","status":"open","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-22T14:07:18Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:07:18Z","dependencies":[{"issue_id":"show_media_bias-main-mpy.3","depends_on_id":"show_media_bias-main-mpy","type":"parent-child","created_at":"2026-02-22T09:07:18Z","created_by":"Mike Crowe","metadata":"{}"}]}
{"id":"show_media_bias-main-mpy.4","title":"Remove Twitter support entirely","description":"Medium Priority: Twitter path handling is incomplete (TODO at get-site-from-url.ts:36). Decision: Remove Twitter support rather than implement. Remove: tw_pages lookups, twitter.com content script, Twitter-related config. Update manifest permissions.","status":"closed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-22T14:07:20Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:43:22Z","closed_at":"2026-02-22T14:43:22Z","close_reason":"Closed","dependencies":[{"issue_id":"show_media_bias-main-mpy.4","depends_on_id":"show_media_bias-main-mpy","type":"parent-child","created_at":"2026-02-22T09:07:19Z","created_by":"Mike Crowe","metadata":"{}"}]}
{"id":"show_media_bias-main-mpy.5","title":"Make fact-check service URL configurable","description":"Medium Priority: factualsearch.news URL is hardcoded in facebook.ts:233. Add config option to allow users to choose their preferred fact-checking service. Store in config-handler.ts.","status":"closed","priority":3,"issue_type":"feature","owner":"drmikecrowe@gmail.com","created_at":"2026-02-22T14:07:21Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:47:27Z","closed_at":"2026-02-22T14:47:27Z","close_reason":"URL only used in documentation links, not in actual functionality. Original facebook.ts reference no longer exists.","dependencies":[{"issue_id":"show_media_bias-main-mpy.5","depends_on_id":"show_media_bias-main-mpy","type":"parent-child","created_at":"2026-02-22T09:07:20Z","created_by":"Mike Crowe","metadata":"{}"}]}
{"id":"show_media_bias-main-rpx","title":"Upgrade React 18.2.0 to latest 18.x","description":"Upgrade React to latest 18.x version. Run: npm install react@18 react-dom@18. Check for any breaking changes in release notes. Verify popup and options pages still render correctly.","status":"closed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:17Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"show_media_bias-main-rqo","title":"Fix uninitialized getDomain return values","description":"Bug: getDomain function may return undefined values in domain or path properties. File: src/shared/get-domain.ts:24. Return explicit default values { domain: '', path: '' } instead of undefined.","status":"closed","priority":2,"issue_type":"bug","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:15Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:40:19Z","closed_at":"2026-02-22T14:40:19Z","close_reason":"Closed"}
{"id":"show_media_bias-main-s96","title":"Verify Node.js 24 and MV3 compliance","description":"After all upgrades, verify: 1) Extension builds successfully with Node 22 LTS, 2) Manifest V3 compliance is maintained, 3) Both Chrome and Firefox builds work. Run npm run build and test the extension.","status":"completed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:21Z","created_by":"Mike Crowe","updated_at":"2026-02-21T21:12:15Z"}
{"id":"show_media_bias-main-sfe","title":"Add user-facing error notifications","description":"Missing Feature: Errors logged to console but users don't know features failed. Add error notification UI for configuration failures or data loading issues.","status":"open","priority":3,"issue_type":"feature","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:33:19Z","created_by":"Mike Crowe","updated_at":"2026-02-21T16:33:19Z"}
{"id":"show_media_bias-main-tj0","title":"Update strict_min_version to Firefox 109 for MV3 compatibility","description":"The current strict_min_version (104) is incompatible with several Manifest V3 features being used:\n\n- 'action' key (requires 109+)\n- 'action.default_icon' (requires 109+)\n- 'action.default_popup' (requires 109+)\n- 'host_permissions' (requires 109+)\n\nSolution: Update strict_min_version from 104 to 109 in manifest.json","status":"in_progress","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:35Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:17:55Z","labels":["firefox","manifest","mv3"]}
{"id":"show_media_bias-main-wgm","title":"Add data_collection_permissions to manifest.json","description":"The /browser_specific_settings/gecko/data_collection_permissions property is now required for all new Firefox extensions and will be required for new versions of existing extensions in the future.\n\nReference: https://mzl.la/firefox-builtin-data-consent","status":"open","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-23T11:14:33Z","created_by":"Mike Crowe","updated_at":"2026-02-23T11:14:33Z","labels":["firefox","manifest"]}
{"id":"show_media_bias-main-xph","title":"Upgrade TypeScript 5.3.3 to 5.7.x","description":"Upgrade TypeScript to latest 5.7.x. Run: npm install typescript@~5.7. Check for any new type errors after upgrade. Fix any breaking type changes.","status":"closed","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T16:30:18Z","created_by":"Mike Crowe","updated_at":"2026-02-22T14:06:37Z","closed_at":"2026-02-22T14:06:37Z","close_reason":"Completed in v4.1 branch"}
{"id":"smb-08t","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"open","priority":2,"issue_type":"molecule","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:25Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:25Z"}
{"id":"smb-6mg","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"open","priority":2,"issue_type":"molecule","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:23Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:23Z"}
{"id":"smb-rig-show_media_bias","title":"show_media_bias","description":"Rig identity bead for show_media_bias.\n\nrepo: git@github.com:drmikecrowe/mbfcext.git\nprefix: smb\nstate: active","status":"open","priority":2,"issue_type":"task","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:27Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:27Z","labels":["gt:rig"]}
{"id":"smb-show_media_bias-refinery","title":"Refinery for show_media_bias - processes merge queue.","description":"Refinery for show_media_bias - processes merge queue.\n\nrole_type: refinery\nrig: show_media_bias\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:22Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:22Z","labels":["gt:agent"]}
{"id":"smb-show_media_bias-witness","title":"Witness for show_media_bias - monitors polecat health and progress.","description":"Witness for show_media_bias - monitors polecat health and progress.\n\nrole_type: witness\nrig: show_media_bias\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:20Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:20Z","labels":["gt:agent"]}
{"id":"smb-y8z","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"open","priority":2,"issue_type":"molecule","owner":"drmikecrowe@gmail.com","created_at":"2026-02-21T20:00:26Z","created_by":"Mike Crowe","updated_at":"2026-02-21T20:00:26Z"}
